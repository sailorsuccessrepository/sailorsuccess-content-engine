---
const currentPath = Astro.url.pathname;
---

<header class="site-header">
  <div class="container">
    <nav class="nav-inner">
      <a href="/" class="logo" aria-label="Sailor Success Home">
        <img src="/images/logo.png" alt="Sailor Success" class="logo-img" width="160" height="44" />
      </a>

      <!-- Desktop nav -->
      <ul class="nav-links" role="list">
        <li><a href="/" class={`nav-link${currentPath === '/' ? ' active' : ''}`}>Home</a></li>
        <li><a href="/our-contributors/" class={`nav-link${currentPath.startsWith('/our-contributors') ? ' active' : ''}`}>Our Contributors</a></li>
        <li><a href="/scamshield/" class={`nav-link${currentPath.startsWith('/scamshield') ? ' active' : ''}`}>Scam Shield</a></li>
        <li><a href="https://sailorsuccess.graphy.com/store" class="nav-link" target="_blank" rel="noopener noreferrer">Courses</a></li>
      </ul>

      <!-- Hamburger button (visible on all screen sizes â€” opens More menu) -->
      <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Open menu" aria-expanded="false" aria-controls="mobileMenu">
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
      </button>

      <!-- SailorGPT CTA â€” always visible -->
      <a href="https://sailorsuccess.graphy.com/t/p/checkout/V4/avatar/68e5d00cca4dc933ce6ebf6f/p8?callback_url=/t/u/ai/avatar" class="nav-cta" target="_blank" rel="noopener noreferrer">ðŸ¤– SailorGPT</a>
    </nav>
  </div>

  <!-- Mobile + More menu (all links, alphabetical) -->
  <div class="mobile-menu" id="mobileMenu" role="dialog" aria-label="Navigation">
    <ul class="mobile-nav-links" role="list">
      <li><a href="/about/" class="mobile-nav-link">About</a></li>
      <li><a href="/careers/" class="mobile-nav-link">Careers</a></li>
      <li><a href="/contact/" class="mobile-nav-link">Contact</a></li>
      <li><a href="/contributors/" class="mobile-nav-link">Contribute</a></li>
      <li><a href="https://sailorsuccess.graphy.com/store" class="mobile-nav-link" target="_blank" rel="noopener noreferrer">Courses</a></li>
      <li><a href="/finance/" class="mobile-nav-link">Finance Guide</a></li>
      <li><a href="/" class="mobile-nav-link">Home</a></li>
      <li><a href="/imucet101/" class="mobile-nav-link">IMU-CET 101</a></li>
      <li><a href="/learn/" class="mobile-nav-link">Learn</a></li>
      <li><a href="/mn101/" class="mobile-nav-link">MN 101</a></li>
      <li><a href="/money/" class="mobile-nav-link">Money</a></li>
      <li><a href="/our-contributors/" class="mobile-nav-link">Our Contributors</a></li>
      <li><a href="/resume-interview/" class="mobile-nav-link">Resume &amp; Interviews</a></li>
      <li><a href="/rights/" class="mobile-nav-link">Rights</a></li>
      <li><a href="/scamshield/" class="mobile-nav-link">Scam Shield</a></li>
      <li><a href="/tools/" class="mobile-nav-link">Tools</a></li>
    </ul>
  </div>
</header>

<style>
  .site-header { position: relative; }
  /* Hamburger always visible â€” it's the More menu on desktop too */
  .mobile-menu-btn { display: flex !important; }
  /* Mobile only: hide desktop nav links (hamburger has everything) */
  @media (max-width: 768px) {
    .nav-links { display: none !important; }
  }
  /* Dropdown panel */
  .mobile-menu {
    position: absolute !important;
    top: 100% !important;
    left: 0 !important;
    right: 0 !important;
    height: auto !important;
    display: none !important;
    padding: 1rem 1.5rem 1.5rem;
    max-height: calc(100vh - 72px);
    overflow-y: auto;
    background: #fff;
    border-top: 1px solid rgba(10,37,64,0.05);
    box-shadow: 0 8px 24px rgba(10,37,64,0.08);
    z-index: 9999 !important;
  }
  .mobile-menu.active {
    display: block !important;
    animation: ssMenuSlide 0.2s ease;
  }
  @keyframes ssMenuSlide {
    from { opacity: 0; transform: translateY(-6px); }
    to   { opacity: 1; transform: translateY(0); }
  }
  .mobile-menu-btn.open .hamburger-line:nth-child(1) { transform: translateY(7px) rotate(45deg); }
  .mobile-menu-btn.open .hamburger-line:nth-child(2) { opacity: 0; transform: scaleX(0); }
  .mobile-menu-btn.open .hamburger-line:nth-child(3) { transform: translateY(-7px) rotate(-45deg); }
</style>

<script>
  const btn = document.getElementById("mobileMenuBtn");
  const menu = document.getElementById("mobileMenu");

  function closeMenu() {
    menu?.classList.remove("active");
    btn?.classList.remove("open");
    btn?.setAttribute("aria-expanded", "false");
    btn?.setAttribute("aria-label", "Open menu");
  }

  btn?.addEventListener("click", (e) => {
    e.stopPropagation();
    const isOpen = menu?.classList.toggle("active");
    btn?.classList.toggle("open", isOpen ?? false);
    btn?.setAttribute("aria-expanded", String(isOpen));
    btn?.setAttribute("aria-label", isOpen ? "Close menu" : "Open menu");
  });

  document.addEventListener("click", (e) => {
    if (menu?.classList.contains("active") && !menu.contains(e.target as Node)) closeMenu();
  });

  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") closeMenu();
  });

  document.querySelectorAll(".mobile-nav-link").forEach(l =>
    l.addEventListener("click", closeMenu)
  );
</script>
