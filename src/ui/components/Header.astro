---
const currentPath = Astro.url.pathname;
---

<header class="site-header">
  <div class="container">
    <nav class="nav-inner">
      <a href="/" class="logo" aria-label="Sailor Success Home">
        <img src="https://sailorsuccess.online/images/logo.png" alt="Sailor Success" class="logo-img" width="160" height="44" />
      </a>

      <ul class="nav-links" role="list">
        <li><a href="/learn/" class={`nav-link${currentPath.startsWith('/learn') ? ' active' : ''}`}>Learn</a></li>
        <li><a href="/careers/" class={`nav-link${currentPath.startsWith('/careers') ? ' active' : ''}`}>Careers</a></li>
        <li><a href="/money/" class={`nav-link${currentPath.startsWith('/money') ? ' active' : ''}`}>Money</a></li>
        <li><a href="/rights/" class={`nav-link${currentPath.startsWith('/rights') ? ' active' : ''}`}>Rights</a></li>
        <li><a href="/tools/" class={`nav-link${currentPath.startsWith('/tools') ? ' active' : ''}`}>Tools</a></li>
        <li><a href="https://sailorsuccess.graphy.com/talk/mentor" class="nav-link nav-cta" target="_blank" rel="noopener noreferrer">SailorGPT</a></li>
      </ul>

      <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Open menu" aria-expanded="false" aria-controls="mobileMenu">
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
      </button>
    </nav>
  </div>

  <div class="mobile-menu" id="mobileMenu" role="dialog" aria-label="Navigation">
    <ul class="mobile-nav-links" role="list">
      <li><a href="/learn/" class="mobile-nav-link">Learn</a></li>
      <li><a href="/careers/" class="mobile-nav-link">Careers</a></li>
      <li><a href="/money/" class="mobile-nav-link">Money</a></li>
      <li><a href="/rights/" class="mobile-nav-link">Rights</a></li>
      <li><a href="/tools/" class="mobile-nav-link">Tools</a></li>
      <li><a href="/about/" class="mobile-nav-link">About</a></li>
      <li><a href="/contact/" class="mobile-nav-link">Contact</a></li>
    </ul>
    <div class="mobile-cta-group">
      <a href="https://sailorsuccess.graphy.com/talk/mentor" class="mobile-cta mobile-cta-primary" target="_blank" rel="noopener noreferrer">Ask SailorGPT Free</a>
      <a href="https://wa.me/919958110235?text=Hi%20Chief%2C%20I%20need%20guidance" class="mobile-cta mobile-cta-secondary" target="_blank" rel="noopener noreferrer">Talk to Chief</a>
    </div>
  </div>
</header>

<style>
  /* Ensure mobile-menu drops down instead of sliding in from side */
  .site-header { position: relative; }
  .mobile-menu {
    position: absolute !important;
    top: 100% !important;
    left: 0 !important;
    right: 0 !important;
    width: 100% !important;
    height: auto !important;
    display: none !important;
    flex-direction: column;
    padding: 1rem 1.5rem 1.5rem;
  }
  .mobile-menu.active {
    display: flex !important;
    animation: ssMenuSlide 0.2s ease;
  }
  @keyframes ssMenuSlide {
    from { opacity: 0; transform: translateY(-6px); }
    to   { opacity: 1; transform: translateY(0); }
  }
  .mobile-menu-btn.open .hamburger-line:nth-child(1) { transform: translateY(7px) rotate(45deg); }
  .mobile-menu-btn.open .hamburger-line:nth-child(2) { opacity: 0; transform: scaleX(0); }
  .mobile-menu-btn.open .hamburger-line:nth-child(3) { transform: translateY(-7px) rotate(-45deg); }
</style>

<script>
  const btn = document.getElementById("mobileMenuBtn");
  const menu = document.getElementById("mobileMenu");

  function closeMenu() {
    menu?.classList.remove("active");
    btn?.classList.remove("open");
    btn?.setAttribute("aria-expanded", "false");
    btn?.setAttribute("aria-label", "Open menu");
  }

  btn?.addEventListener("click", (e) => {
    e.stopPropagation();
    const isOpen = menu?.classList.toggle("active");
    btn?.classList.toggle("open", isOpen);
    btn?.setAttribute("aria-expanded", String(isOpen));
    btn?.setAttribute("aria-label", isOpen ? "Close menu" : "Open menu");
  });

  document.addEventListener("click", (e) => {
    if (menu?.classList.contains("active") && !menu.contains(e.target as Node)) closeMenu();
  });

  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") closeMenu();
  });

  document.querySelectorAll(".mobile-nav-link, .mobile-cta").forEach(l =>
    l.addEventListener("click", closeMenu)
  );
</script>
